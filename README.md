# Billing System

## Description

This is a partially built billing service with a single `POST` endpoint called `/usageReport`, used to log user service usage,
built for demostration purposes. The project comes with an accompaning client library that other services can use to call the web server.

#### Properties:

-   Built using `Typescript`, `NodeJs`.
-   Uses `Jest` as its testing framework
-   Has persistent database storage. It uses `Postgres`, `Docker` and `Docker volumes` to achieve this.
-   Implements runtime type checking through the use of the `io-ts & fp-ts` libraries.
-   Basic error handling. Example: requests with incorrectly formatted data, return a `400` status code.

## Assumptions

1. User usage billing is unique on the `customerId` and `service` name. I.e: A single record is allowed to exist with a unique `customerId` and `service` values.
2. Post requests create new entries, `PUT/PATCH` requests update records.
3. The webserver and api-library are exclusively utilized by authenticated parties.

## Production Changes

These are some of the changes I would make if this project was to go live in production.

-   Improved error handling, such as custom error classes.
-   Greater granularity in error types. More specific paths for different scenarios.
    Example: Currently if a user submits a string value in the `customerId` field, this is generically handled.
    A `400` status code is returned and the default error message generated by the runtime type checker will be returned.
    This for example could be more gracefully handled.
-   Caching.
-   Dockerize the entire web server for easier development across teams. Currently the db is exclusively dockerized.
-   Improved file structure. Currently everything resides in the `/src` folder of the application.

## Set up

### APILibrary

[Instructions](./apiLibrary/README.md)

## WebServer

[Instructions](./webServer/README.md)

## Database

Once the the webserver has been intantiated and the database container created and is running we can connect to it through the following steps.

1. Install [psql](https://www.timescale.com/blog/how-to-install-psql-on-mac-ubuntu-debian-windows/)
2. Connect to the database: `psql -h localhost -U postgres -d billing_records`;
3. View inserted usage records. `SELECT * from usage_records;`
